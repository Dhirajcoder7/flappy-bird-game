<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flappy Bird Clone</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
    }

    .background {
      height: 100vh;
      width: 100vw;
      background: url('background-img.png') no-repeat center center fixed;
      background-size: cover;
    }

    .bird {
      height: 100px;
      width: 130px;
      position: fixed;
      top: 40vh;
      left: 30vw;
      z-index: 100;
      transition: transform 0.2s;
    }

    .pipe_sprite {
      position: fixed;
      top: 40vh;
      left: 100vw;
      height: 70vh;
      width: 6vw;
      background: radial-gradient(lightgreen 50%, green);
      border: 5px solid black;
    }

    .message {
      position: absolute;
      z-index: 10;
      color: black;
      top: 30%;
      left: 50%;
      font-size: 4em;
      transform: translate(-50%, -50%);
      text-align: center;
    }

    .messageStyle {
      background: white;
      padding: 30px;
      box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
      border-radius: 5%;
    }

    .score {
      position: fixed;
      z-index: 10;
      height: 10vh;
      font-size: 10vh;
      font-weight: 100;
      color: white;
      -webkit-text-stroke-width: 2px;
      -webkit-text-stroke-color: black;
      top: 0;
      left: 0;
      margin: 10px;
    }

    .score_val {
      color: gold;
      font-weight: bold;
    }

    @media (max-width: 1080px) {
      .message {
        font-size: 2em;
        top: 50%;
        white-space: nowrap;
      }

      .score {
        font-size: 6vh;
      }

      .bird {
        width: 100px;
        height: 80px;
        left: 25vw;
      }

      .pipe_sprite {
        width: 12vw;
      }
    }

    @media (max-width: 480px) {
      .message {
        font-size: 1.5em;
        padding: 10px;
      }

      .bird {
        width: 80px;
        height: 65px;
      }

      .pipe_sprite {
        width: 14vw;
      }

      .score {
        font-size: 5vh;
      }
    }
  </style>
</head>
<body>
  <div class="background"></div>
  <img src="Bird.png" alt="bird-img" class="bird" id="bird-1" />
  <div class="message">
    Enter / Tap to Start Game
    <p><span style="color: red;">â†‘</span> Arrow / Tap to Jump</p>
  </div>
  <div class="score">
    <span class="score_title"></span>
    <span class="score_val"></span>
  </div>

  <script>
    let move_speed = 3,
      gravity = 0.5;
    let bird = document.querySelector(".bird");
    let img = document.getElementById("bird-1");
    let sound_point = new Audio("point.mp3");
    let sound_die = new Audio("die.mp3");

    let bird_props = bird.getBoundingClientRect();
    let background = document.querySelector(".background").getBoundingClientRect();

    let score_val = document.querySelector(".score_val");
    let message = document.querySelector(".message");
    let score_title = document.querySelector(".score_title");

    let game_state = "Start";
    img.style.display = "none";
    message.classList.add("messageStyle");

    // Start game
    function startGame() {
      if (game_state !== "Play") {
        document.querySelectorAll(".pipe_sprite").forEach((e) => e.remove());
        img.style.display = "block";
        bird.style.top = "40vh";
        game_state = "Play";
        message.innerHTML = "";
        score_title.innerHTML = "Score : ";
        score_val.innerHTML = "0";
        message.classList.remove("messageStyle");
        play();
      }
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "Enter") startGame();
    });

    document.addEventListener("touchstart", (e) => {
      if (game_state !== "Play") startGame();
    });

    function play() {
      function move() {
        if (game_state !== "Play") return;

        document.querySelectorAll(".pipe_sprite").forEach((element) => {
          let pipe_props = element.getBoundingClientRect();
          bird_props = bird.getBoundingClientRect();

          if (pipe_props.right <= 0) {
            element.remove();
          } else {
            if (
              bird_props.left < pipe_props.left + pipe_props.width &&
              bird_props.left + bird_props.width > pipe_props.left &&
              bird_props.top < pipe_props.top + pipe_props.height &&
              bird_props.top + bird_props.height > pipe_props.top
            ) {
              gameOver();
              return;
            } else {
              if (
                pipe_props.right < bird_props.left &&
                pipe_props.right + move_speed >= bird_props.left &&
                element.increase_score === "1"
              ) {
                score_val.innerHTML = +score_val.innerHTML + 1;
                sound_point.play();
              }
              element.style.left = pipe_props.left - move_speed + "px";
            }
          }
        });
        requestAnimationFrame(move);
      }
      requestAnimationFrame(move);

      let bird_dy = 0;

      function apply_gravity() {
        if (game_state !== "Play") return;

        bird_dy += gravity;

        bird.style.top = bird_props.top + bird_dy + "px";
        bird_props = bird.getBoundingClientRect();

        if (bird_props.top <= 0 || bird_props.bottom >= background.bottom) {
          gameOver();
          return;
        }

        requestAnimationFrame(apply_gravity);
      }

      requestAnimationFrame(apply_gravity);

      document.addEventListener("keydown", (e) => {
        if (e.key === "ArrowUp" || e.key === " ") {
          img.src = "Bird-2.png";
          bird_dy = -7.6;
        }
      });

      document.addEventListener("keyup", (e) => {
        if (e.key === "ArrowUp" || e.key === " ") {
          img.src = "Bird.png";
        }
      });

      document.addEventListener("touchstart", () => {
        img.src = "Bird-2.png";
        bird_dy = -7.6;
        setTimeout(() => (img.src = "Bird.png"), 200);
      });

      let pipe_separation = 0;
      const pipe_gap = 35;

      function create_pipe() {
        if (game_state !== "Play") return;

        if (pipe_separation > 115) {
          pipe_separation = 0;
          let pipe_posi = Math.floor(Math.random() * 43) + 8;

          let pipe_top = document.createElement("div");
          pipe_top.className = "pipe_sprite";
          pipe_top.style.top = pipe_posi - 70 + "vh";
          pipe_top.style.left = "100vw";

          let pipe_bottom = document.createElement("div");
          pipe_bottom.className = "pipe_sprite";
          pipe_bottom.style.top = pipe_posi + pipe_gap + "vh";
          pipe_bottom.style.left = "100vw";
          pipe_bottom.increase_score = "1";

          document.body.appendChild(pipe_top);
          document.body.appendChild(pipe_bottom);
        }

        pipe_separation++;
        requestAnimationFrame(create_pipe);
      }

      requestAnimationFrame(create_pipe);
    }

    function gameOver() {
      game_state = "End";
      message.innerHTML = "Game Over".fontcolor("red") + "<br>Press Enter / Tap To Restart";
      message.classList.add("messageStyle");
      img.style.display = "none";
      sound_die.play();
    }
  </script>
</body>
</html>
